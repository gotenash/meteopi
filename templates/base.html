<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Station M√©t√©o{% endblock %}</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <style>
        /* Styles pour le mode sombre */
        body.dark-mode {
            background-color: #121212;
            color: #e0e0e0;
        }
        body.dark-mode .card {
            background-color: #1e1e1e;
            color: #e0e0e0;
            box-shadow: 0 4px 8px rgba(0,0,0,0.5);
        }
        body.dark-mode .navbar {
            background-color: #2c3e50;
            border-bottom: 1px solid #444;
        }
        /* Overrides pour les √©l√©ments sp√©cifiques de home.html */
        body.dark-mode .weather-secondary {
            background-color: #2d2d2d !important;
            color: #ddd;
        }
        body.dark-mode .weather-temp {
            color: #fff !important;
        }
        body.dark-mode .weather-details, 
        body.dark-mode .temp-label {
            color: #ccc !important;
        }
        body.dark-mode .bar-track {
            background-color: #444 !important;
        }
        /* Formulaires en mode sombre */
        body.dark-mode input, body.dark-mode select, body.dark-mode textarea {
            background-color: #333;
            color: #fff;
            border: 1px solid #555;
        }
        #dark-mode-toggle { cursor: pointer; background: none; border: none; font-size: 1.2em; padding: 8px; color: inherit; }
    </style>
</head>
<body>
    {% if current_user.is_authenticated %}
    <nav class="navbar">
        <div class="navbar-brand">
            <a href="{{ url_for('home') }}" style="display: flex; align-items: center; text-decoration: none; color: inherit;">
                <img src="{{ url_for('static', filename='img/meteopi.png') }}" alt="Logo" height="30" style="margin-right: 10px;">
                Station M√©t√©o
            </a>
        </div>
        <ul class="navbar-nav">
            <li><a href="{{ url_for('home') }}">Tableau de Bord</a></li>
            <li class="dropdown"> 
                <input type="checkbox" id="dropdown-toggle" class="dropdown-toggle">
                <label for="dropdown-toggle" class="dropbtn">Graphiques</label>
                <div class="dropdown-content">
                    <a href="{{ url_for('hourly_graph') }}">Temp/Humidit√© (48h)</a>
                    <a href="{{ url_for('pressure_graph') }}">Pression</a>
                    <a href="{{ url_for('rain_graph') }}">Pluie</a>
                    <a href="{{ url_for('wind_rose') }}">Vent</a>
                </div>
            </li> 
            <li><a href="{{ url_for('satellite_page') }}">Satellite</a></li>
            <li><a href="{{ url_for('history') }}">Historique</a></li>
            <li><a href="{{ url_for('admin_page') }}">Administration</a></li>
            <li><a href="{{ url_for('logout') }}">D√©connexion</a></li>
            <li><button id="dark-mode-toggle" title="Basculer le mode sombre">üåô</button></li>
        </ul>
    </nav>
    {% endif %}

    <div class="container">
        {# Affiche les messages flash (erreurs, succ√®s, etc.) #}
        {% with messages = get_flashed_messages(with_categories=true) %}
          {% if messages %}
            {% for category, message in messages %}
              <div class="alert alert-{{ category }}">{{ message }}</div>
            {% endfor %}
          {% endif %}
        {% endwith %}

        {% block content %}{% endblock %}
    </div>

    <footer style="text-align: center;">
        <p>Station M√©t√©o - 2025</p>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const toggleBtn = document.getElementById('dark-mode-toggle');
            const body = document.body;
            
            // V√©rifier la pr√©f√©rence enregistr√©e dans le navigateur
            if (localStorage.getItem('darkMode') === 'enabled') {
                body.classList.add('dark-mode');
                if(toggleBtn) toggleBtn.textContent = '‚òÄÔ∏è';
            }

            if(toggleBtn) {
                toggleBtn.addEventListener('click', () => {
                    body.classList.toggle('dark-mode');
                    const isDark = body.classList.contains('dark-mode');
                    localStorage.setItem('darkMode', isDark ? 'enabled' : 'disabled');
                    toggleBtn.textContent = isDark ? '‚òÄÔ∏è' : 'üåô';
                });
            }
        });
    </script>
</body>
</html>
